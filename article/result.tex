\section{系统实验与结果分析}

\subsection{数据处理}

\subsubsection{数据集的来源}

对于游戏推荐算法的研究较少，
数据集的获取也较为困难，
为了兼顾用户数据与游戏数据的广泛性与准确性，
最终选择加利福尼亚大学圣迭戈分校（UCSD）
的Steam游戏数据集
（\url{https://cseweb.ucsd.edu/~jmcauley/datasets.html#steam_data}）。

该数据集的基本统计情况如\cref{tb:dataset}所示。

\begin{table}[!htbp]
	\begin{center}
		\caption{Steam数据集基本统计情况}\label{tb:dataset}
		\begin{tabular}{cccc}
			\toprule
			条目 & 数量        & 条目 & 数量     \\
			\midrule
			评论 & 7,793,069 & 项目 & 15,474 \\
			用户 & 2,567,538 & 合集 & 615    \\
			\bottomrule
		\end{tabular}
	\end{center}
\end{table}

\subsubsection{数据集的预处理}

由于数据集分别包含了评论数据、
用户数据、
游戏数据、
合集数据等。
为了更方便地使用数据集进行训练，
选择将澳大利亚的用户数据、
澳大利亚用户评论数据、
游戏数据进行内连接。

鉴于数据集中有一定数据的缺失，
选择将例如游戏制造商、
游戏发行商、
游戏标题等数据填充为\verb|NONE|，
将游戏标签、
游戏风格、
游戏类型等修改为空列表，
游戏价格填充为\verb|0|。

之后对密集数据进行标准化，
标准化的公式为：
\begin{equation}
	\hat{x} = \frac{x-\mu}{\sigma}
\end{equation}

其中$\mu$为数据的平均值，
$\sigma$为数据的方差。

对数据集处理后的可用条目为53,973条。
选择将数据进行8--2划分，
分别作为训练集和验证集。

\subsubsection{Word2Vec到Tag2Vec的迁移}

由于Word2Vec本质上属于是利用上下文数据来进行词嵌入，
对于tag来说可以认为每一条目的标签均为一个句子，
可以根据tag的共现规律进行Word2Vec的训练，
可以很好地解决OneHot编码过于稀疏的问题。
Word2Vec相较于FM等算法其计算性能较高，
可以很好地应用于标签的特征提取。
同时，
对于训练数据而言，
每一条目的标签不多，
不需要设置过大的窗口，
且几乎没有数据的损失。
因此可以作为模型的预训练部分。

\subsection{模型设计}

模型主要将数据分为三个部分：
稀疏数据、
稠密数据、
标签数据。
稀疏数据主要通过FM进行特征提取，
标签数据则通过Word2Vec进行特征提取，
最终将三者通过全连接层连接，
之后使用深度神经网络进行处理并得到结果，
最终与用户打分进行比较。
对于模型的设计见\cref{fig:model}。

\begin{figure}[!htbp]
	\centering
	\includegraphics[width=.9\textwidth]{images/model.pdf}
	\caption{模型设计}\label{fig:model}
\end{figure}

\subsubsection{FM模块设计}

FM模块主要将离散数据分别交给嵌入层和全连接层进行处理，
其中全连接层输出神经元为$1$，
之后将嵌入层的数据交由FM层处理后与线性层结果相加，
最后与嵌入层的数据拼接后输出。
模块的设计主要见\cref{fig:fm}

\begin{figure}[!htbp]
	\centering
	\includegraphics[width=.9\textwidth]{images/fm.pdf}
	\caption{FM模块设计}\label{fig:fm}
\end{figure}

\subsubsection{Word2Vec模块设计}

Word2Vec模块主要在预训练阶段把标签数据进行训练，
对于数据集中的风格、
标签、
类型等信息分别进行训练，
并得出维度为$50$的向量，
对每一相应的标签数据对应的向量相加，
将其作为相应的向量，
拼接后作为输出。

\subsubsection{深度神经网络模块设计}

深度神经网络模块的输入数据为$454$维，
首先将数据通过输出为$454$维的全连接层进行训练，
之后通过维度为$150$的全连接层训练，
第三层则为输出为$50$维的全连接层，
第四层和第五层全连接层的输出维度为$10$和$1$，
其中全连接层之间的激活函数均为ReLU，
第五层和输出间的激活函数为Sigmoid。
网络的设计可见\cref{fig:deep}。

\begin{figure}[!htbp]
	\centering
	\includegraphics[width=.9\textwidth]{images/deep.pdf}
	\caption{深度神经网络模块设计}\label{fig:deep}
\end{figure}

\subsection{评价指标}

为了评价建立模型的优劣，
需要建立一个相应的评价体系。
对于本文而言，
其推荐质量的评价主要是通过
对给定数据产生推荐结果的准确性实现。

该推荐算法对游戏的预测主要是对游戏评分的预测，
算法根据用户对游戏评分的多少进行相应的推荐。
因此，
需要一种算法来衡量算法预测评分和用户真实评分的
一种评价指标。
通常的评价指标有：
均方误差损失、
平均绝对值误差损失、
交叉熵损失、
负对数似然函数损失等等。
鉴于该问题适用于二分类问题
（用户评分只有推荐与否），
因此为避免类似于均方误差损失等带来的梯度消失等一系列问题，
因此采用二分类交叉熵损失（BCE）。
其计算公式为：
\begin{equation}
	L=-\sum_{i=1}^{N}\left[y_{i} \ln \left(\sigma\left(x_{i}\right)\right)+\left(1-y_{i}\right) \ln \left(1-\sigma\left(x_{i}\right)\right)\right]
\end{equation}

此时有：
\begin{equation}
	\begin{aligned}
		\frac{d L}{d x_{i}} & =\frac{d L}{d \sigma\left(x_{i}\right)} \cdot \frac{d \sigma\left(x_{i}\right)}{d x_{i}}                                                                                         \\
		                    & =-\left[\frac{y_{i}}{\sigma\left(x_{i}\right)}+\left(1-y_{i}\right) \frac{-1}{1-\sigma\left(x_{i}\right)}\right] \sigma\left(x_{i}\right)\left(1-\sigma\left(x_{i}\right)\right) \\
		                    & =\left(\frac{1-y_{i}}{1-\sigma\left(x_{i}\right)}-\frac{y_{i}}{\sigma\left(x_{i}\right)}\right) \sigma\left(x_{i}\right)\left(1-\sigma\left(x_{i}\right)\right)                  \\
		                    & =\left(1-y_{i}\right) \sigma\left(x_{i}\right)-y_{i}\left(1-\sigma\left(x_{i}\right)\right)                                                                                      \\
		                    & =\sigma\left(x_{i}\right)-y_{i}
	\end{aligned}
\end{equation}

其中$ \sigma(x)=\frac{1}{1+e^{-x}} $。

此时可以看到采用Sigmoid作为激活函数与
BCE作为损失函数所得到的梯度值正比于预测值与真实值之差。